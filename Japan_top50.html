<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script type="text/javascript" src="./d3.js"></script>
  </head>
  <body>
    <div id="app">
      <h1>日本top50</h1>
      <a href="./Japan_top50_energy.html">energy </a>
      <a href="./Japan_top50_danceability.html">danceability </a>
      <a href="./Japan_top50_tempo.html">tempo </a>
      <a href="./Japan_top50_acousticness.html">acousticness </a>
      <a href="./Japan_top50_valence.html">valence </a>
      <a href="./Japan_top50_popularity.html">popularity </a>
    </div>
    <script type = "text/javascript">
        d3.csv("./scraping/icon.csv").then(function(data){
            var icon = data;
            console.log(data);
            let center_button = false;
            var svg = d3.select("body").append("svg")
                        .attr("width",3840)
                        .attr("height",2400);
            
            var icons = svg.selectAll("icons")
                            .data(icon)
                            .enter()
                            .append("image");
            
            icons.attr("x",1920)
                    .attr("y",1200)
                    .attr("height",0)
                    .attr("width",0)
                    .attr("xlink:href",function(d){
                        console.log(d.image);
                        return d.image;
                    })
                    .attr("opacity",0)
                    .on("mouseover",function(d){
                        d3.select(this).transition().duration(100)
                                        .attr("height",200)
                                        .attr("width",200)
                    })
                    .on("mouseout",function(d){
                        d3.select(this).transition().duration(100)
                                        .attr("height",100)
                                        .attr("width",100)
                    })
            
            data2 = [10]
            var circle2 = svg.selectAll("circle2")
                            .data(data2)
                            .enter()
                            .append("circle")
                            .attr("cx",1920)
                            .attr("cy",1200)
                            .attr("r",120)
                            .attr("fill","black")
                            .attr("stroke","rgb(30,215,96)")
                           
            var defs = svg.append('defs');
            var circles = defs
                            .append('circle')
                            .attr('id', 'circle')
                            .attr('r', 200)
                            .attr('cx', 1920)
                            .attr('cy', 1200);
        
            defs.append('clipPath')
                .attr('id', 'clip')
                .append('use')
                .attr('xlink:href', '#circle')


            var images = svg
                .append('image')
                .attr('xlink:href', 'Spotify_Icon_RGB_Green.png')
                .attr('width', 480)
                .attr('height', 300)
                .attr('clip-path', 'url(#clip)')
                .attr('x', 1680)
                .attr('y', 1050)
                .on("click",function(){
                    center_button = !center_button
                    if(center_button){
                        icons.transition()
                        .attr("x",function(d,i){
                            return 1860+400*Math.cos(2*Math.PI*i/6)})
                        .attr("y",function(d,i){
                            return 1160+400*Math.sin(2*Math.PI*i/6)})
                        .attr("height",100)
                        .attr("width",100)
                        .attr("opacity",1)
                    }
                    else{
                        icons.transition()
                        .attr("x",1920)
                        .attr("y",1200)
                        .attr("height",0)
                        .attr("width",0)
                        .attr("opacity",0)
                    }
                })
                .on("mouseover",function(){
                    circle2.attr("fill","orange")
                            .attr("stroke","rgb(30,215,96)")
                })
                .on("mouseout",function(){
                    circle2.attr("fill","black")
                            .attr("stroke","rgb(30,215,96)")
                })
        })
      </script>
  </body>
</html>
